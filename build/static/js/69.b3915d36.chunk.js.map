{"version":3,"sources":["Webviews/ThreedsStatusWebviewIOS/action.js","Webviews/ThreedsStatusWebviewIOS/ThreedsStatusPageIOS.js"],"names":["REACT_APP_PAYMENT_VOUCHER","process","BEARER_TOKEN","REACT_APP_BEARER_TOKEN","myHeaders","REACT_APP_BASE_URL","Headers","append","concat","ThreedsStatus","_ref","cartId","transactionId","callback","raw","JSON","stringify","requestOptions","method","headers","body","redirect","fetch","then","response","json","result","catch","error","ThreedsStatusPageIOS","_useState","useState","code","_useState2","_slicedToArray","status","URLSearchParams","window","location","search","get","_useState3","_useState4","loading","setLoading","isFoo","href","indexOf","document","getElementsByTagName","classValue","_setThreeDsStatus","_asyncToGenerator","_regeneratorRuntime","mark","_callee","message","wrap","_context","prev","next","res","webkit","messageHandlers","ThreedsStatusFun","postMessage","stop","apply","arguments","className","reason","redirectUrl","returnUrl","setupIntentResponseDetail","loaderImage","getFileSrcFromPublicFolder","_jsxs","children","FAEText","style","textAlign","_jsx","FAELoading","type","height","_Fragment","FAEButton","onClick","_x","_x2","_x3","setThreeDsStatus"],"mappings":"0PACMA,G,MAA4BC,mIAAYD,2BACxCE,EAAcD,mIAAYE,uBAM5BC,GALiBH,mIAAYI,mBAKjB,IAAIC,SACpBF,EAAUG,OAAO,eAAgB,oBACjCH,EAAUG,OAAO,OAAQ,WACzBH,EAAUG,OAAO,gBAAgB,UAADC,OAAYN,IAC5CE,EAAUG,OAAO,8BAA8B,KAExC,IAAME,EAAgB,SAAHC,GAA8C,IAAxCC,EAAMD,EAANC,OAASC,EAAaF,EAAbE,cAAeC,EAAQH,EAARG,SAEpDC,EAAMC,KAAKC,UAAU,CACtBL,OAASA,EACTC,cAAgBA,IAEfK,EAAiB,CACnBC,OAAQ,OACRC,QAASf,EACTgB,KAAMN,EACNO,SAAU,UAEZ,OAAOC,MAAM,GAADd,OAAIR,EAAyB,0BAA0BiB,GAChEM,MAAK,SAAAC,GAAQ,OAAIA,EAASC,MAAM,IAChCF,MAAK,SAAAG,GAAM,OAAKb,EAASa,EAAO,IAChCC,OAAM,SAAAC,GAAK,OAAIf,EAASe,EAAM,GACjC,E,oCCoCeC,EAtDc,WAC3B,IAAAC,EAA0BC,mBAAS,CAACC,KAAK,MAAKC,EAAAC,YAAAJ,EAAA,GAAvCK,EAAMF,EAAA,GACPtB,GADkBsB,EAAA,GACT,IAAIG,gBAAgBC,OAAOC,SAASC,QAAQC,IAAI,WACzD5B,EAAgB,IAAIwB,gBAAgBC,OAAOC,SAASC,QAAQC,IAAI,iBACtEC,EAA6BV,oBAAS,GAAMW,EAAAR,YAAAO,EAAA,GAArCE,EAAOD,EAAA,GAAEE,EAAUF,EAAA,GACpBG,EAAQR,OAAOC,SAASQ,KAAKC,QAAQ,YAAc,EACnD3B,EAAO4B,SAASC,qBAAqB,QAAQ,GAC7CC,EAAaL,EAAQ,YAAc,qBAeX,SAAAM,IAQ5B,OAR4BA,EAAAC,YAAAC,cAAAC,MAA/B,SAAAC,EAAgCvB,EAAMJ,EAAO4B,GAAO,OAAAH,cAAAI,MAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,OAClC,OAAhBhB,GAAW,GAAKc,EAAAE,KAAA,EACRnD,EAAc,CACbE,SACAC,gBACAC,SAAU,SAACgD,GAAG,OAAIxB,OAAOyB,OAAOC,gBAAgBC,iBAAiBC,YAAaJ,EAAI,IACtF,KAAD,SAAAH,EAAAE,KAAA,EACEhB,GAAW,GAAM,wBAAAc,EAAAQ,OAAA,GAAAX,EAAA,MACtBY,MAAA,KAAAC,UAAA,CAtBAhD,EAAKiD,UAAYjD,EAAKiD,UAAY,IAAKnB,EAuBzC,IAAQlB,EAAkFG,EAAlFH,KAAMwB,EAA4ErB,EAA5EqB,QAAqE5B,GAAOO,EAAnEmC,OAAmEnC,EAA1DoC,YAA0DpC,EAA7CqC,UAA6CrC,EAAlCsC,0BAAkCtC,EAAPP,OAE/E8C,EAAcC,YAA2B,cAC7C,OACIC,eAAA,OAAKP,UAAU,sBAAqBQ,SAAA,CACjClC,GACFiC,eAACE,UAAO,CAACC,MAAO,CAACC,UAAU,UAAUH,SAAA,CACnCI,cAACC,aAAU,CAACC,KAAK,MAAMT,YAAaA,EAAaU,OAAO,UAAU,iBAGnER,eAAAS,WAAA,CAAAR,SAAA,CACAI,cAACH,UAAO,CAAAD,SACLrB,IAEHyB,cAACK,YAAS,CAACC,QAAS,kBAxB1B,SAC8BC,EAAAC,EAAAC,GAAA,OAAAvC,EAAAgB,MAAC,KAADC,UAAA,CAuBAuB,CAAiB3D,EAAMJ,EAAO4B,EAAS,EAACqB,SAAC,iBAOzE,C","file":"static/js/69.b3915d36.chunk.js","sourcesContent":["import { fetchAction } from \"../../redux/utils\";\r\nconst REACT_APP_PAYMENT_VOUCHER = process.env.REACT_APP_PAYMENT_VOUCHER;\r\nconst BEARER_TOKEN= process.env.REACT_APP_BEARER_TOKEN\r\nconst APP_BASE_URL = process.env.REACT_APP_BASE_URL;\r\n\r\n//business availibility\r\n\r\n\r\nvar myHeaders = new Headers();\r\nmyHeaders.append(\"Content-Type\", \"application/json\"); \r\nmyHeaders.append(\"mode\", \"no-cors\");\r\nmyHeaders.append(\"Authorization\", `Bearer ${BEARER_TOKEN}`); \r\nmyHeaders.append(\"Access-Control-Allow-Origin\",\"*\");\r\n\r\nexport const ThreedsStatus = ({ cartId , transactionId, callback }) => {\r\n \r\nvar raw = JSON.stringify({\r\n   cartId : cartId,\r\n   transactionId : transactionId\r\n});\r\nvar requestOptions = {\r\n  method: 'POST',\r\n  headers: myHeaders,\r\n  body: raw,\r\n  redirect: 'follow'\r\n}; \r\nreturn fetch(`${REACT_APP_PAYMENT_VOUCHER}/Payment/ThreedsStatus`, requestOptions)\r\n  .then(response => response.json())\r\n  .then(result =>  callback(result))\r\n  .catch(error => callback(error)); \r\n};\r\n \r\n\r\nexport const capturePaymenFetch = ({ \r\n  cartId,\r\n  paymentAmount,\r\n  stripePaymentMethodId,\r\n  userCountryId, \r\n  bookingId, \r\n  voucherCode, \r\n  userCurrencyCode,\r\n  transactionId,\r\n  userId}) => {\r\n \r\n  var data = JSON.stringify({ \r\n    bookingId :bookingId,\r\n    cartId : cartId ,\r\n    countryId :userCountryId,\r\n    currency :userCurrencyCode,\r\n    paymentAmount,\r\n    returnUrl: `${document.domain=='localhost'?'https://expert-dev.findanexpert.net/paymentverification':document.domain.indexOf(\"findanexpert\") !==-1 ?`https://${document.domain}/paymentverification`:\"https://www.expert.one/paymentverification\"}`,\r\n    stripePaymentMethodId :stripePaymentMethodId,\r\n    transactionId :transactionId,\r\n    userId :userId,\r\n    voucherCode :voucherCode  \r\n });\r\n  var requestOptions = {\r\n    method: 'POST',\r\n    headers: myHeaders,\r\n    body: data,\r\n    redirect: 'follow'\r\n  }; \r\n  return fetch( `${REACT_APP_PAYMENT_VOUCHER}/Payment/CapturePayment`, requestOptions)\r\n    .then(response => response.json())\r\n    .then(result =>  result)\r\n    .catch(error => error); \r\n  };\r\n\r\n\r\n  export function oneTimeCapture(oneTimeCaptureObj){\r\n    \r\n    var requestOptions = {\r\n      method: 'POST',\r\n      headers: myHeaders,\r\n      body: JSON.stringify(oneTimeCaptureObj),\r\n      redirect: 'follow'\r\n    }; \r\n\r\n     return fetch(`${REACT_APP_PAYMENT_VOUCHER}/OneTimePayment/CapturePayment`,requestOptions)\r\n     .then(jsondata => {\r\n      return jsondata?.json();\r\n     }).then((resp) => {\r\n      return resp \r\n    })\r\n    .catch(e => {\r\n      console.log('e', e)\r\n    })\r\n\r\n  }\r\n\r\n  export function oneTimeHoldPayment(oneTimeHoldPaymentObj){\r\n    var requestOptions = {\r\n      method: 'POST',\r\n      headers: myHeaders,\r\n      body: JSON.stringify(oneTimeHoldPaymentObj),\r\n      redirect: 'follow'\r\n    }; \r\n  return  fetch(`${REACT_APP_PAYMENT_VOUCHER}/OneTimePayment/HoldPayment`,requestOptions).then(response => response?.json())\r\n          .then((resp) =>  resp  )\r\n          .catch(e => console.log('e', e) )\r\n  }\r\n  \r\n  export function oneTimeThreedsStatus(oneTimeThreedsStatusObj){\r\n    var requestOptions = {\r\n      method: 'POST',\r\n      headers: myHeaders,\r\n      body: JSON.stringify(oneTimeThreedsStatusObj),\r\n      redirect: 'follow'\r\n    }; \r\n    return fetch(`${REACT_APP_PAYMENT_VOUCHER}/OneTimePayment/ThreedsStatus`,requestOptions).then(response => response?.json())\r\n    .then((resp) =>  resp)\r\n    .catch(e => console.log('e', e))\r\n  }\r\n \r\nexport function getClinicAddressAPI(getclinicPayload){\r\n  var requestOptions = {\r\n    method: 'POST',\r\n    headers: myHeaders,\r\n    body: JSON.stringify(getclinicPayload),\r\n    redirect: 'follow'\r\n  }; \r\nreturn  fetch(`${APP_BASE_URL}/Addresses/GetClinicAddresses`,requestOptions).then(response => response?.json())\r\n        .then((resp) =>  resp  )\r\n        .catch(e => console.log('e', e) )\r\n}","//libs\r\nimport React, { createRef, useEffect, useState } from \"react\"; \r\nimport { FAEText, FAELoading } from \"@findanexpert-fae/components\"; \r\n\r\n//src\r\nimport { ThreedsStatus } from \"./action\"; \r\n\r\n//scss\r\nimport \"./ThreedsStatus.scss\"; \r\nimport { getFileSrcFromPublicFolder } from \"../../utils\";\r\nimport { FAEButton } from \"@findanexpert-fae/components/dist/stories/FAEButton/FAEButton\";\r\n\r\nconst ThreedsStatusPageIOS = () => { \r\n  const [status, setStatus]=useState({code:400})\r\n  const cartId = new URLSearchParams(window.location.search).get(\"cartId\");\r\n  const transactionId = new URLSearchParams(window.location.search).get(\"transactionId\");\r\n  const [loading, setLoading]= useState(false)\r\n    var isFoo = window.location.href.indexOf('foo.com') > -1;\r\n    var body = document.getElementsByTagName(\"body\")[0];\r\n    var classValue = isFoo ? 'foo-class' : 'threeds-body-class';\r\n    body.className = body.className + ' '+ classValue; \r\n  \r\n  // useEffect(async () => { \r\n  //  await  ThreedsStatus({\r\n  //           cartId,\r\n  //           transactionId,\r\n  //           callback: (res) =>  \r\n  //           window.webkit.messageHandlers.ThreedsStatusFun.postMessage(  \r\n  //             res?.code, res?.message, res?.reason,  res?.redirectUrl, res?.returnUrl, res?.setupIntentResponseDetail, res?.error\r\n  //           ),\r\n  //       }).then((res=>{\r\n  //         setStatus(res)\r\n  //       }));\r\n  // }, []);\r\n async function setThreeDsStatus(code, error, message) {\r\n   setLoading(true)\r\n    await  ThreedsStatus({\r\n            cartId,\r\n            transactionId,\r\n            callback: (res) =>window.webkit.messageHandlers.ThreedsStatusFun.postMessage( res)\r\n     });\r\n   await setLoading(false)\r\n   }\r\n  const { code, message, reason,  redirectUrl, returnUrl, setupIntentResponseDetail, error}=status\r\n \r\nconst loaderImage = getFileSrcFromPublicFolder(\"loader.GIF\");\r\n  return ( \r\n      <div className=\"fae-threeds-webview\">\r\n       { loading && \r\n       <FAEText style={{textAlign:\"center\"}}>\r\n         <FAELoading type=\"svg\" loaderImage={loaderImage} height=\"200px\" />\r\n          Loading ...\r\n       </FAEText>}\r\n        <>\r\n        <FAEText>\r\n          {message} \r\n        </FAEText>\r\n        <FAEButton onClick={()=>setThreeDsStatus(code, error, message )}>\r\n          Proceed\r\n        </FAEButton>\r\n       </> \r\n    </div>\r\n      \r\n  );\r\n};\r\n\r\nexport default ThreedsStatusPageIOS;\r\n"],"sourceRoot":""}